21 March 2013: Added server location as parameter (thx Markus Schroer for idea)
some optimized error handling code
13 July  2015: Fixed data extraction code (thx Rene Schroeder)